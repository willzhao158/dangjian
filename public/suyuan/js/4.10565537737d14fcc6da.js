webpackJsonp([4],{"85Tj":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("vLgD");var s=a("mw3O"),l=a.n(s),o={data:function(){return{parkid:0,parkname:"",dataList:[],isAdd:!0,dialogVisible:!1,form:{plotname:"",crop:"",kind:"",plotarea:"",contact:"",contacttel:"",plotsoil:[],plottype:"1",plotsrc:[],coordinates:"",growth_name:"",crop_growth:[]},cropData:[],kindData:[],rules:{plotname:[{required:!0,message:"请输入地块名称",trigger:"blur"}],plotarea:[{required:!0,message:"请输入面积",trigger:"blur"}],kind:[{required:!0,message:"请输入面积",trigger:"change"}],growth_name:[{required:!0,message:"请输入日历名称",trigger:"blur"}]}}},methods:{initData:function(){isNaN(Number(this.$route.params.id))||(this.parkid=Number(this.$route.params.id),this.doSearch(l.a.stringify({parkid:this.parkid})))},doSearch:function(t){var e=this;(function(t){return Object(i.a)({url:"place/list",method:"post",data:t})})(t).then(function(t){1==t.code?(e.parkname=t.data.parkname,e.dataList=t.data.data):e.$message.error(t.msg)}).catch(function(t){e.$message.error(t)})},add:function(){this.isAdd=!0,this.dialogVisible=!0,this.resetForm(),this.ininPlant()},edit:function(t){this.isAdd=!1,this.dialogVisible=!0,this.resetForm(),this.ininPlant(),this.form=t},remove:function(t){var e=this;this.$confirm("此操作将删除该地块, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.$message({type:"success",message:"删除成功!"})}).catch(function(){})},addRow:function(){this.form.plotsoil.push({name:"",number:"",unit:""})},removeRow:function(t){this.form.plotsoil.splice(t,1)},save:function(){var t=this;this.$refs.form.validate(function(e){if(!e)return t.$message.error("请检查您的输入！"),!1;var a,s=!0;if(t.form.crop_growth.forEach(function(t){""!=t.startdate&&""!=t.enddate||(s=!1)}),!s)return t.$message.error("请检查您的输入！"),!1;t.form.parkid=t.parkid,t.isAdd?(a=l.a.stringify(t.form),Object(i.a)({url:"place/add",method:"post",data:a})).then(function(e){1==e.code?(t.$message({message:e.msg,type:"success"}),t.doSearch(l.a.stringify({parkid:t.parkid})),t.dialogVisible=!1):t.$message.error(e.msg)}).catch(function(e){t.$message.error(e)}):function(t){return Object(i.a)({url:"place/edit",method:"post",data:t})}(l.a.stringify(t.form)).then(function(e){1==e.code?(t.$message({message:e.msg,type:"success"}),t.doSearch(l.a.stringify({parkid:t.parkid})),t.dialogVisible=!1):t.$message.error(e.msg)}).catch(function(e){t.$message.error(e)})})},resetForm:function(){this.form={plotname:"",crop:"",kind:"",plotarea:"",contact:"",contacttel:"",plotsoil:[],plottype:"1",plotsrc:[],coordinates:"",growth_name:"",crop_growth:[]}},ininPlant:function(){var t=this;Object(i.a)({url:"place/crop",method:"post"}).then(function(e){if(1==e.code)for(var a in e.data)t.cropData.push(e.data[a]);else t.$message.error(e.msg)}).catch(function(e){t.$message.error(e)})},chooseCrop:function(t){var e=this;this.form.kind="",this.kindData=[],this.cropData.forEach(function(a){if(t!=a.id);else for(var i in a.child)e.kindData.push(a.child[i])})},chooseKind:function(t){var e=this;this.form.crop_growth=[],Object(i.a)({url:"Phenological/list",method:"post"}).then(function(a){1==a.code?a.data.forEach(function(a){t==a.id&&a.data.forEach(function(t){var a={name:t.growthname,startdate:"",enddate:""};e.form.crop_growth.push(a)})}):e.$message.error(a.msg)}).catch(function(t){e.$message.error(t)})},clearRow:function(t){t.startdate="",t.enddate=""}},created:function(){this.initData()},mounted:function(){}},r={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"page-container"},[i("el-main",[i("el-row",[i("div",{staticClass:"park-title"},[t._v(t._s(t.parkname))])]),t._v(" "),i("el-row",[i("div",{staticClass:"plot-list"},[t._l(t.dataList,function(e,a){return[i("div",{key:a,staticClass:"plot-item"},[i("div",{staticClass:"flex flex-align-center flex-pack-justify"},[i("div",{staticClass:"flex flex-align-center"},[i("div",{staticClass:"plot-name m-r-20"},[t._v(t._s(e.plotname))]),t._v(" "),i("div",{staticClass:"plot-trace"},[i("i",{staticClass:"el-icon-position"}),t._v(" "),i("span",{staticClass:"font-14"},[t._v("追溯")])])]),t._v(" "),i("div",{staticClass:"flex flex-align-center"},[i("div",{staticClass:"plot-info m-r-20",on:{click:function(a){return a.stopPropagation(),t.edit(e)}}},[i("i",{staticClass:"el-icon-warning-outline"}),t._v(" "),i("span",{staticClass:"font-14"},[t._v("地块信息")])]),t._v(" "),i("el-button",{attrs:{size:"small"},on:{click:function(e){return e.stopPropagation(),t.remove(a)}}},[t._v("删除")])],1)]),t._v(" "),i("div",{staticClass:"plot-statistics flex flex-pack-justify m-t-30"},[i("div",{staticClass:"statistics-item flex-1 flex flex-align-center flex-pack-center"},[i("i",{staticClass:"el-icon-coin m-r-20"}),t._v(" "),i("div",[i("h1",[t._v("施药")]),t._v(" "),i("h2",[t._v(t._s(e.shiyao))])])]),t._v(" "),i("div",{staticClass:"statistics-item flex-1 flex flex-align-center flex-pack-center"},[i("i",{staticClass:"el-icon-data-analysis m-r-20"}),t._v(" "),i("div",[i("h1",[t._v("施肥")]),t._v(" "),i("h2",[t._v(t._s(e.shifei))])])]),t._v(" "),i("div",{staticClass:"statistics-item flex-1 flex flex-align-center flex-pack-center"},[i("i",{staticClass:"el-icon-place m-r-20"}),t._v(" "),i("div",[i("h1",[t._v("农事")]),t._v(" "),i("h2",[t._v(t._s(e.working))])])]),t._v(" "),i("div",{staticClass:"statistics-item flex-1 flex flex-align-center flex-pack-center"},[i("i",{staticClass:"el-icon-first-aid-kit m-r-20"}),t._v(" "),i("div",[i("h1",[t._v("采集")]),t._v(" "),i("h2",[t._v(t._s(e.collect))])])]),t._v(" "),i("div",{staticClass:"statistics-item flex-1 flex flex-align-center flex-pack-center"},[i("i",{staticClass:"el-icon-truck m-r-20"}),t._v(" "),i("div",[i("h1",[t._v("巡园")]),t._v(" "),i("h2",[t._v(t._s(e.touring))])])])]),t._v(" "),i("el-row",{staticClass:"m-t-30",attrs:{type:"flex",justify:"space-between",align:"middle"}},[i("el-col",{attrs:{span:12}},[i("ul",{staticClass:"plot-intro m-r-30 flex-1"},[i("li",{staticClass:"flex flex-align-center flex-pack-justify"},[i("span",[t._v("作物")]),t._v(" "),i("p",[t._v(t._s(e.crop))])]),t._v(" "),i("li",{staticClass:"flex flex-align-center flex-pack-justify"},[i("span",[t._v("品种")]),t._v(" "),i("p",[t._v(t._s(e.kind))])]),t._v(" "),i("li",{staticClass:"flex flex-align-center flex-pack-justify"},[i("span",[t._v("预警")]),t._v(" "),i("el-badge",{staticClass:"item",attrs:{value:e.warning,type:"warning"}})],1),t._v(" "),i("li",{staticClass:"flex flex-align-center flex-pack-justify"},[i("span",[t._v("在线设备")]),t._v(" "),i("el-badge",{staticClass:"item",attrs:{value:e.deviceOn,type:"success"}})],1),t._v(" "),i("li",{staticClass:"flex flex-align-center flex-pack-justify"},[i("span",[t._v("离线设备")]),t._v(" "),i("el-badge",{staticClass:"item",attrs:{value:e.deviceOff,type:"info"}})],1)])])],1)],1)]}),t._v(" "),i("div",{staticClass:"plot-item",on:{click:t.add}},[i("div",{staticClass:"add-item text-center"},[i("i",{staticClass:"el-icon-circle-plus-outline"}),t._v(" "),i("p",[t._v("新建地块")])])])],2)]),t._v(" "),i("el-dialog",{attrs:{title:"地块信息",visible:t.dialogVisible,width:"1200px","close-on-click-modal":!1},on:{"update:visible":function(e){t.dialogVisible=e}}},[i("el-form",{ref:"form",attrs:{size:"small",rules:t.rules,model:t.form,"label-width":"150px"}},[i("el-tabs",{attrs:{"tab-position":"left"}},[i("el-tab-pane",{attrs:{label:"地块资料"}},[i("el-form-item",{attrs:{label:"地块名称",prop:"plotname"}},[i("el-input",{staticStyle:{width:"450px"},attrs:{placeholder:"请输入地块名称"},model:{value:t.form.plotname,callback:function(e){t.$set(t.form,"plotname",e)},expression:"form.plotname"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"种植面积",prop:"plotarea"}},[i("el-input",{staticStyle:{width:"260px"},attrs:{placeholder:"请输入面积"},model:{value:t.form.plotarea,callback:function(e){t.$set(t.form,"plotarea",e)},expression:"form.plotarea"}},[i("template",{slot:"append"},[t._v("亩")])],2)],1),t._v(" "),i("el-form-item",{attrs:{label:"联系人姓名",prop:"contact"}},[i("el-input",{staticStyle:{width:"260px"},attrs:{placeholder:"请输入联系人姓名"},model:{value:t.form.contact,callback:function(e){t.$set(t.form,"contact",e)},expression:"form.contact"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"联系电话",prop:"contacttel"}},[i("el-input",{staticStyle:{width:"260px"},attrs:{placeholder:"请输入联系电话"},model:{value:t.form.contacttel,callback:function(e){t.$set(t.form,"contacttel",e)},expression:"form.contacttel"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"土肥情况",prop:"plotsoil"}},[i("el-table",{staticStyle:{width:"100%"},attrs:{data:t.form.plotsoil,size:"mini",border:""}},[i("el-table-column",{attrs:{prop:"name",label:"名称"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-input",{attrs:{size:"mini"},model:{value:e.row.name,callback:function(a){t.$set(e.row,"name",a)},expression:"scope.row.name"}})]}}])}),t._v(" "),i("el-table-column",{attrs:{prop:"number",label:"数量"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-input",{attrs:{size:"mini"},model:{value:e.row.number,callback:function(a){t.$set(e.row,"number",a)},expression:"scope.row.number"}})]}}])}),t._v(" "),i("el-table-column",{attrs:{prop:"unit",label:"单位"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-input",{attrs:{size:"mini"},model:{value:e.row.unit,callback:function(a){t.$set(e.row,"unit",a)},expression:"scope.row.unit"}})]}}])}),t._v(" "),i("el-table-column",{attrs:{label:"操作",width:"80px"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(a){return t.removeRow(e.$index)}}},[t._v("删除")])]}}])})],1),t._v(" "),i("el-button",{staticClass:"m-t-5",attrs:{size:"mini",type:"text"},on:{click:t.addRow}},[t._v("+ 添加成分")])],1)],1),t._v(" "),i("el-tab-pane",{attrs:{label:"物候期"}},[i("el-form-item",{attrs:{label:"日历名称",prop:"growth_name"}},[i("el-input",{staticStyle:{width:"450px"},attrs:{placeholder:"请输入日历名称"},model:{value:t.form.growth_name,callback:function(e){t.$set(t.form,"growth_name",e)},expression:"form.growth_name"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"种植作物及品种",prop:"kind"}},[i("el-select",{staticStyle:{width:"220px"},attrs:{filterable:"",placeholder:"请选择作物"},on:{change:t.chooseCrop},model:{value:t.form.crop,callback:function(e){t.$set(t.form,"crop",e)},expression:"form.crop"}},t._l(t.cropData,function(t){return i("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}),1),t._v(" "),i("el-select",{staticStyle:{width:"220px"},attrs:{"allow-create":"",filterable:"",placeholder:"请选择品种"},on:{change:t.chooseKind},model:{value:t.form.kind,callback:function(e){t.$set(t.form,"kind",e)},expression:"form.kind"}},t._l(t.kindData,function(t){return i("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}),1)],1),t._v(" "),i("el-form-item",{attrs:{label:"物候期详情",prop:"crop_growth"}},[i("el-table",{staticStyle:{width:"100%"},attrs:{data:t.form.crop_growth,size:"mini",border:""}},[i("el-table-column",{attrs:{prop:"name",label:"序号",width:"60px"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("span",[t._v(t._s(e.$index+1))])]}}])}),t._v(" "),i("el-table-column",{attrs:{prop:"number",label:"物候期名称"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-input",{attrs:{readonly:"",size:"mini"},model:{value:e.row.name,callback:function(a){t.$set(e.row,"name",a)},expression:"scope.row.name"}})]}}])}),t._v(" "),i("el-table-column",{attrs:{prop:"unit",label:"开始时间"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-date-picker",{attrs:{size:"mini",type:"date",placeholder:"选择日期"},model:{value:e.row.startdate,callback:function(a){t.$set(e.row,"startdate",a)},expression:"scope.row.startdate"}})]}}])}),t._v(" "),i("el-table-column",{attrs:{prop:"unit",label:"结束时间"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-date-picker",{attrs:{size:"mini",type:"date",placeholder:"选择日期"},model:{value:e.row.enddate,callback:function(a){t.$set(e.row,"enddate",a)},expression:"scope.row.enddate"}})]}}])}),t._v(" "),i("el-table-column",{attrs:{label:"操作",width:"80px"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(a){return t.clearRow(e.row)}}},[t._v("清空")])]}}])})],1)],1)],1),t._v(" "),i("el-tab-pane",{attrs:{label:"地块形状"}}),t._v(" "),i("el-tab-pane",{attrs:{label:"地块平面图"}},[i("el-form-item",{attrs:{label:"选择平面图",prop:"plottype"}},[i("el-radio-group",{model:{value:t.form.plottype,callback:function(e){t.$set(t.form,"plottype",e)},expression:"form.plottype"}},[i("el-radio",{attrs:{label:"1",border:""}},[t._v("地块")]),t._v(" "),i("el-radio",{attrs:{label:"2",border:""}},[t._v("温室")]),t._v(" "),i("el-radio",{attrs:{label:"3",border:""}},[t._v("大棚")]),t._v(" "),i("el-radio",{attrs:{label:"4",border:""}},[t._v("自定义")])],1)],1),t._v(" "),i("div",{staticClass:"text-center m-t-30"},["1"==t.form.plottype?i("img",{attrs:{width:"90%",src:a("Sknh"),alt:""}}):t._e(),t._v(" "),"2"==t.form.plottype?i("img",{attrs:{width:"90%",src:a("oCW+"),alt:""}}):t._e(),t._v(" "),"3"==t.form.plottype?i("img",{attrs:{width:"90%",src:a("a/YU"),alt:""}}):t._e(),t._v(" "),"4"==t.form.plottype?i("div",{staticStyle:{"min-height":"300px"}},[i("el-upload",{attrs:{action:"https://jsonplaceholder.typicode.com/posts/","file-list":t.form.plotsrc}},[i("el-button",{attrs:{size:"small",type:"primary"}},[t._v("上传图片")]),t._v(" "),i("div",{staticClass:"m-t-10",attrs:{slot:"tip"},slot:"tip"},[t._v("只能上传jpg/png文件，且不超过500kb")])],1)],1):t._e()])],1)],1)],1),t._v(" "),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{size:"small"},on:{click:function(e){t.dialogVisible=!1}}},[t._v("取消")]),t._v(" "),i("el-button",{attrs:{size:"small",type:"primary"},on:{click:t.save}},[t._v("保存")])],1)],1)],1)],1)},staticRenderFns:[]};var n=a("VU/8")(o,r,!1,function(t){a("nA81")},null,null);e.default=n.exports},Sknh:function(t,e,a){t.exports=a.p+"suyuan/img/bg-monitor-default.a451354.png"},"a/YU":function(t,e,a){t.exports=a.p+"suyuan/img/bg-monitor-greenhouse.1ab22c9.png"},nA81:function(t,e){},"oCW+":function(t,e,a){t.exports=a.p+"suyuan/img/bg-monitor-glasshouse.efa4631.png"}});
//# sourceMappingURL=4.10565537737d14fcc6da.js.map